!function(e){var t={};function i(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(a,o,function(t){return e[t]}.bind(null,o));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){i(2),e.exports=i(1)},function(e,t,i){},function(e,t,i){"use strict";function a(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return{code:e,value:t,shift:i}}function o(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"virtual-keyboard__key-func-wide";return{code:e,title:t,class:i,shift:!1}}i.r(t);var r={lang:"en",keys:[[a("Backquote","`","~"),a("Digit1","1","!"),a("Digit2","2","@"),a("Digit3","3","#"),a("Digit4","4","$"),a("Digit5","5","%"),a("Digit6","6","^"),a("Digit7","7","&"),a("Digit8","8","*"),a("Digit9","9","("),a("Digit0","0",")"),a("Minus","-","_"),a("Equal","=","+")],[a("KeyQ","q"),a("KeyW","w"),a("KeyE","e"),a("KeyR","r"),a("KeyT","t"),a("KeyY","y"),a("KeyU","u"),a("KeyI","i"),a("KeyO","o"),a("KeyP","p"),a("BracketLeft","[","{"),a("BracketRight","]","}"),a("Backslash","\\","|")],[a("KeyA","a"),a("KeyS","s"),a("KeyD","d"),a("KeyF","f"),a("KeyG","g"),a("KeyH","h"),a("KeyJ","j"),a("KeyK","k"),a("KeyL","l"),a("Semicolon",";",":"),a("Quote","'",'"')],[a("KeyZ","z"),a("KeyX","x"),a("KeyC","c"),a("KeyV","v"),a("KeyB","b"),a("KeyN","n"),a("KeyM","m"),a("Comma",",","<"),a("Period",".",">"),a("Slash","/","?")]]},s=[{lang:"ru",keys:[[a("Backquote","ё"),a("Digit1","1","!"),a("Digit2","2",'"'),a("Digit3","3","№"),a("Digit4","4",";"),a("Digit5","5","%"),a("Digit6","6",":"),a("Digit7","7","?"),a("Digit8","8","*"),a("Digit9","9","("),a("Digit0","0",")"),a("Minus","-","_"),a("Equal","=","+")],[a("KeyQ","й"),a("KeyW","ц"),a("KeyE","у"),a("KeyR","к"),a("KeyT","е"),a("KeyY","н"),a("KeyU","г"),a("KeyI","ш"),a("KeyO","щ"),a("KeyP","з"),a("BracketLeft","х"),a("BracketRight","ъ"),a("Backslash","\\","/")],[a("KeyA","ф"),a("KeyS","ы"),a("KeyD","в"),a("KeyF","а"),a("KeyG","п"),a("KeyH","р"),a("KeyJ","о"),a("KeyK","л"),a("KeyL","д"),a("Semicolon","ж"),a("Quote","э")],[a("KeyZ","я"),a("KeyX","ч"),a("KeyC","с"),a("KeyV","м"),a("KeyB","и"),a("KeyN","т"),a("KeyM","ь"),a("Comma","б"),a("Period","ю"),a("Slash",".",",")]]},r],n=["Backspace","Tab","Delete","CapsLock","Enter","ShiftLeft","ShiftRight","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","ControlLeft","ControlRight","AltLeft","AltRight","Space","MetaLeft","MetaRight"],l="virtual-keyboard__key-func-arrow",c=[{right:[o("Backspace","Backspace")]},{left:[o("Tab","Tab")],right:[o("Delete","Del")]},{left:[o("CapsLock","Caps Lock")],right:[o("Enter","ENTER")]},{left:[o("ShiftLeft","Shift")],right:[o("ArrowUp","Up",l),o("ShiftRight","Shift",l)]},{left:[o("ControlLeft","Ctrl"),o("MetaLeft","Win"),o("AltLeft","Alt"),o("Space","","virtual-keyboard__key-func-space")],right:[o("AltRight","Alt"),o("ControlRight","Ctrl"),o("ArrowLeft","Left",l),o("ArrowDown","Down",l),o("ArrowRight","Right",l)]}];function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var d=function(){function e(t,i){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];u(this,e),this.isShifted=!1,this.isPressed=!1,this.el=t,this.char=a,this.code=i,this.shiftCharacter=o,this.el.addEventListener("click",this.clickListener.bind(this))}var t,i,a;return t=e,(i=[{key:"clickListener",value:function(e){e.preventDefault(),this.el.dispatchEvent(new CustomEvent("vir-key-click",{detail:{keyObj:this},bubbles:!0,cancelable:!0}))}},{key:"getValue",value:function(){return!0===this.isShifted?!0===this.shiftCharacter?this.char.toUpperCase():this.shiftCharacter:this.char}},{key:"setShifted",value:function(e,t){e&&!this.isShifted?(this.isShifted=!0,!0===this.shiftCharacter&&this.el.classList.add(t)):!e&&this.isShifted&&(this.isShifted=!1,!0===this.shiftCharacter&&this.el.classList.remove(t))}},{key:"setPressed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"virtual-keyboard__key-pressed-true";e&&!this.isPressed?(this.isPressed=!0,this.el.classList.add(t)):!e&&this.isPressed&&(this.isPressed=!1,this.el.classList.remove(t))}},{key:"pressAnimatation",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"virtual-keyboard__key-animation-click";this.el.classList.add(t),setTimeout((function(){e.el.classList.remove(t)}),0)}}])&&h(t.prototype,i),a&&h(t,a),e}();function y(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.outputEl=t}var t,i,a;return t=e,(i=[{key:"write",value:function(e){var t=this.outputEl.selectionStart,i=this.outputEl.selectionEnd,a=this.outputEl.value,o=a.slice(0,t)+e+a.slice(i,a.length);this.outputEl.value=o,this.outputEl.selectionStart=t+1,this.outputEl.selectionEnd=t+1,this.outputEl.focus()}},{key:"backspace",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.outputEl.selectionStart,i=this.outputEl.selectionEnd,a=this.outputEl.value,o=a,r=t;t===i&&(!e&&t>0&&(o=a.slice(0,t-1)+a.slice(t,a.length),r-=1),e&&t<a.length&&(o=a.slice(0,t)+a.slice(t+1,a.length))),t!==i&&(o=a.slice(0,t)+a.slice(i,a.length)),this.outputEl.value=o,this.outputEl.selectionStart=r,this.outputEl.selectionEnd=r,this.outputEl.focus()}},{key:"navigate",value:function(e){var t=this.outputEl.selectionStart,i=this.outputEl.selectionEnd;switch(e){case"left":this.outputEl.selectionStart=t-1,this.outputEl.selectionEnd=t-1;break;case"right":this.outputEl.selectionStart=i+1,this.outputEl.selectionEnd=i+1;break;case"up":this.outputEl.selectionStart=0,this.outputEl.selectionEnd=0;break;case"down":this.outputEl.selectionStart=this.outputEl.value.length,this.outputEl.selectionEnd=this.outputEl.value.length}this.outputEl.focus()}}])&&y(t.prototype,i),a&&y(t,a),e}();function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var i=[],a=!0,o=!1,r=void 0;try{for(var s,n=e[Symbol.iterator]();!(a=(s=n.next()).done)&&(i.push(s.value),!t||i.length!==t);a=!0);}catch(e){o=!0,r=e}finally{try{a||null==n.return||n.return()}finally{if(o)throw r}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return p(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var b=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;g(this,e),this.layouts={},this.layoutCodes=[],this.selectedLayoutCode=null,this.rootDomElement=null,this.observedKeyCodes={},this.languageConfig=t,this.pressedFunctionalButtons=new Set}var t,i,a;return t=e,a=[{key:"createLangLayout",value:function(e){var t=document.createElement("div"),i={},a=0;return c.forEach((function(o){var r=document.createElement("div");r.classList.add("virtual-keyboard__row"),Object.prototype.hasOwnProperty.call(o,"left")&&o.left.length>0&&o.left.forEach((function(e){var t=document.createElement("div");t.classList.add("virtual-keyboard__key"),t.innerHTML="<span>".concat(e.title,"</span>"),t.classList.add(e.class),r.appendChild(t),i[e.code]=new d(t,e.code)})),void 0!==e.keys[a]&&e.keys[a].forEach((function(e){var t=e.value,a=e.shift,o=document.createElement("div");o.classList.add("virtual-keyboard__key"),!0===e.shift&&(a=t.toUpperCase(),o.classList.add("virtual-keyboard__key-type-char")),o.innerHTML="<span>".concat(a,"</span><span>").concat(t,"</span>"),r.appendChild(o),i[e.code]=new d(o,e.code,e.value,e.shift)})),Object.prototype.hasOwnProperty.call(o,"right")&&o.right.length>0&&o.right.forEach((function(e){var t=document.createElement("div");t.classList.add("virtual-keyboard__key"),t.innerHTML="<span>".concat(e.title,"</span>"),t.classList.add(e.class),r.appendChild(t),i[e.code]=new d(t,e.code)})),t.appendChild(r),a+=1})),[t,i]}}],(i=[{key:"attach",value:function(e,t){this.writer=new f(t),this.initData(this.languageConfig),e.appendChild(this.rootDomElement),this.initClicksListener(),this.initPhysicalKeyListener()}},{key:"isShiftEnabled",value:function(){return this.pressedFunctionalButtons.has("ShiftLeft")||this.pressedFunctionalButtons.has("ShiftRight")}},{key:"toggleShift",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=!t&&this.isShiftEnabled(),a=Object.keys(this.observedKeyCodes[this.selectedLayoutCode]);a.forEach((function(t){e.observedKeyCodes[e.selectedLayoutCode][t].setShifted(i,"virtual-keyboard__key-shifted-true")}))}},{key:"initPhysicalKeyListener",value:function(){var e=this,t=function(t){t.preventDefault();var i=t.repeat,a=t.type,o=t.code,r="keyup"!==a,s=e.observedKeyCodes[e.selectedLayoutCode][o];if(s)if(i||(s.setPressed(r),r&&s.pressAnimatation()),n.includes(o))switch(o){case"Backspace":r&&e.writer.backspace();break;case"Delete":r&&e.writer.backspace(!0);break;case"Space":r&&e.writer.write(" ");break;case"Enter":r&&e.writer.write("\n");break;case"Tab":r&&e.writer.write("\t");break;case"ArrowLeft":case"ArrowUp":case"ArrowRight":case"ArrowDown":r&&e.writer.navigate(o.slice(5).toLowerCase());break;case"ShiftRight":case"ShiftLeft":case"AltLeft":case"AltRight":case"ControlLeft":case"ControlRight":r?e.pressedFunctionalButtons.add(o):(e.pressedFunctionalButtons.delete(o),e.checkLayoutToggleCombo(o,!1)),e.toggleShift()}else r&&e.writer.write(s.getValue())};document.onkeydown=t,document.onkeyup=t}},{key:"initClicksListener",value:function(){var e=this;this.rootDomElement.addEventListener("vir-key-click",(function(t){var i=t.detail.keyObj;i.pressAnimatation();var a=i.code;if(n.includes(a))switch(a){case"Backspace":e.writer.backspace();break;case"Delete":e.writer.backspace(!0);break;case"Space":e.writer.write(" ");break;case"Enter":e.writer.write("\n");break;case"Tab":e.writer.write("\t");break;case"ArrowLeft":case"ArrowUp":case"ArrowRight":case"ArrowDown":e.writer.navigate(a.slice(5).toLowerCase());break;case"ShiftRight":case"ShiftLeft":case"AltLeft":case"AltRight":case"ControlLeft":case"ControlRight":e.funcKeyPressedToggleByKeyCode(a),e.toggleShift()}else{var o=i.getValue();e.writer.write(o)}}))}},{key:"funcKeyPressedToggleByKeyCode",value:function(e){var t=this.observedKeyCodes[this.selectedLayoutCode][e];this.pressedFunctionalButtons.has(e)?(this.pressedFunctionalButtons.delete(e),t.setPressed(!1)):this.checkLayoutToggleCombo(e)||(this.pressedFunctionalButtons.add(e),t.setPressed(!0))}},{key:"checkLayoutToggleCombo",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!1,a=!1;switch(e){case"AltLeft":a="ControlLeft";break;case"AltRight":a="ControlRight";break;case"ControlLeft":a="AltLeft";break;case"ControlRight":a="AltRight";break;default:return!1}return this.pressedFunctionalButtons.has(a)&&(t&&this.funcKeyPressedToggleByKeyCode(a),this.nextLayout(),i=!0),i}},{key:"initData",value:function(e){var t=this;this.rootDomElement=document.createElement("div"),this.rootDomElement.classList.add("virtual-keyboard"),this.generateLayouts(e),this.nextLayout(!0),this.layoutCodes.forEach((function(e){var i=t.layouts[e];t.rootDomElement.appendChild(i)})),this.displayCurrentLayout()}},{key:"nextLayout",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!0!==t){var i=new Set(this.pressedFunctionalButtons);this.pressedFunctionalButtons.forEach((function(t){e.funcKeyPressedToggleByKeyCode(t)})),this.toggleShift(!0);var a=this.layoutCodes.indexOf(this.selectedLayoutCode);if(a+1===this.layoutCodes.length){var o=v(this.layoutCodes,1),r=o[0];this.selectedLayoutCode=r}else{var s=this.layoutCodes[a+1];this.selectedLayoutCode=s}localStorage.setItem("layout",this.selectedLayoutCode),this.displayCurrentLayout(),this.pressedFunctionalButtons=i,this.pressedFunctionalButtons.forEach((function(t){e.observedKeyCodes[e.selectedLayoutCode][t].setPressed(!0)})),this.toggleShift()}else{try{var n=localStorage.getItem("layout");if(this.layoutCodes.includes(n))return void(this.selectedLayoutCode=n);var l=v(this.layoutCodes,1);n=l[0],this.selectedLayoutCode=n}catch(e){var c=v(this.layoutCodes,1),u=c[0];this.selectedLayoutCode=u}localStorage.setItem("layout",this.selectedLayoutCode)}}},{key:"displayCurrentLayout",value:function(){var e=this;this.layoutCodes.forEach((function(t){var i=e.layouts[t];i.classList.add("virtual-keyboard__layout"),t!==e.selectedLayoutCode?i.classList.add("virtual-keyboard__layout-hidden-true"):i.classList.remove("virtual-keyboard__layout-hidden-true")}))}},{key:"generateLayouts",value:function(e){var t=this;e.forEach((function(e){var i=v(t.constructor.createLangLayout(e),2),a=i[0],o=i[1];t.layouts[e.lang]=a,t.observedKeyCodes[e.lang]=o,t.layoutCodes.push(e.lang)}))}}])&&k(t.prototype,i),a&&k(t,a),e}();window.onload=function(){var e=document.createElement("div");e.classList.add("wrapper"),e.innerHTML='<div class="output"><textarea placeholder="Смена раскладки - Ctrl+Alt" id="output" class="output__textarea"></textarea></div><div id="keyboard"></div>',document.body.prepend(e);var t=document.getElementById("output"),i=document.getElementById("keyboard");(new b).attach(i,t)}}]);